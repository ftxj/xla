import imp
import os
import torch
import torch_xla
import torch_xla.core.xla_model as xm

os.environ['GPU_NUM_DEVICES']="1"
print('------------------------------------------------------------------')
d=xm.xla_device(0)
print('------------------------------------------------------------------')
t1 = torch.randn(2, 2, device=d)
print('------------------------------------------------------------------')
t2 = torch.randn(2, 2, device=d)
print('------------------------------------------------------------------')
t3 = torch.nn.functional.relu(t1)
print('------------------------------------------------------------------')
t4 = torch.abs(t2)
print('------------------------------------------------------------------')
t = t3 + t4
print('------------------------------------------------------------------')
xm.mark_step()
print('------------------------------------------------------------------')
print(t)